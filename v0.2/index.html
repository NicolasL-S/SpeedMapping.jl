<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SpeedMapping.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SpeedMapping.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NicolasL-S/SpeedMapping.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SpeedMapping.jl"><a class="docs-heading-anchor" href="#SpeedMapping.jl">SpeedMapping.jl</a><a id="SpeedMapping.jl-1"></a><a class="docs-heading-anchor-permalink" href="#SpeedMapping.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="SpeedMapping.speedmapping" href="#SpeedMapping.speedmapping"><code>SpeedMapping.speedmapping</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SpeedMapping</code></pre><p><code>speedmapping(x₀; m!, kwargs...)</code> accelerates the convergence of a mapping  <code>m!(x_out, x_in)</code> to a fixed point of <code>m!</code> by the Alternating cyclic  extrapolation algorithm (ACX). Since gradient descent is an example  of such mapping, <code>speedmapping(x0; g!, kwargs...)</code> can also perform multivariate  optimization based on the gradient function <code>g!(∇, x)</code>.</p><p>Reference: N. Lepage-Saucier, <em>Alternating cyclic extrapolation methods for optimization  algorithms</em>, arXiv:2104.04974 (2021). https://arxiv.org/abs/2104.04974</p><p><strong>Arguments</strong></p><ul><li><code>x₀ :: AbstractArray</code>: The starting point; must be of eltype <code>Float</code>.</li></ul><p>Main keyword arguments:</p><ul><li><code>m!(x_out, x_in)</code>: A map for which a fixed-point must be found.</li><li><code>g!(∇, x)</code>: The gradient of a function to be minimized.</li><li><code>f(x)</code>: The objective of the function to be minimized. It is useful to <em>i</em>)   compute a good initial α (learning  rate) for the gradient descent, <em>ii</em>)   optimize using autodiff or <em>iii</em>) track the progress of the algorithm.</li><li><code>lower, upper :: Union{AbstractArray, Nothing} = nothing</code>: Box constraints    for the optimization. NOTE: When appropriate, it should also be used with    <code>m!</code>. Even if <code>m!</code> always keeps <code>x_out</code> within bounds, an extrapolation    step could throw <code>x</code> out of bounds.</li><li><code>tol :: Float64 = 1e-10, Lp :: Real = 2</code> When using <code>m!</code>, the algorithm    stops when <code>norm(F(xₖ) - xₖ, Lp) ≤ tol</code>. When using <code>g!</code>, the algorithm    stops when <code>norm(∇f(xₖ), Lp) ≤ tol</code>. </li><li><code>maps_limit :: Real = 1e6</code>: Maximum number of <code>m!</code> calls or <code>g!</code> calls. </li><li><code>time_limit :: Real = 1000</code>: Maximum time in seconds.</li></ul><p>Minor keyword arguments:</p><ul><li><code>orders :: Array{Int64} = [3, 3, 2]</code> determines <code>ACX</code>&#39;s alternating order.    Must be between 1 and 3 (where 1 means no extrapolation). The two recommended   orders are [3, 2] and [3, 3, 2], the latter being <em>potentially</em> better for    highly non-linear applications (see paper).</li><li><code>check_obj :: Bool = false</code>: In case of <code>NaN</code> or <code>Inf</code> values, the algorithm   restarts at the best past iterate. If <code>check_obj = true</code>, progress is    monitored with the value of the objective (requires <code>f</code>).    Otherwise, it is monitored with <code>norm(F(xₖ) - xₖ, Lp)</code>. Advantages of    <code>check_obj = true</code>: more precise and if the algorithm convergences on a bad    local minimum, the algorithm instead returns the best past iterate.    Advantages of <code>check_obj = false</code>: for well-behaved applications, it avoids    the effort and time of providing <code>f</code> and calling it at every    iteration.</li><li><code>store_info :: Bool = false</code>: Stores <code>xₖ</code>, <code>σₖ</code> and <code>αₖ</code> (see paper).</li><li><code>buffer :: Float64 = 0.01</code> If <code>xₖ</code> goes out of bounds, it is brought back in   with a buffer. Ex. <code>xₖ = buffer * xₖ₋₁ + (1 - buffer) * upper</code>. Setting    <code>buffer = 0.001</code> may speed-up box-constrained optimization.</li></ul><p>Keyword arguments to fine-tune fixed-point mapping acceleration (using <code>m!</code>):</p><ul><li><code>σ_min :: Real = 0.0</code>: Setting to <code>1</code> may avoid stalling   (see paper).</li><li><code>stabilize :: Bool = false</code>: performs a stabilization mapping before    extrapolating. Setting to <code>true</code> may improve the performance for    applications like the EM or MM algorithm (see paper).</li></ul><p><strong>Example: Finding a dominant eigenvalue</strong></p><pre><code class="language-julia-repl">julia&gt; using LinearAlgebra

julia&gt; using SpeedMapping

julia&gt; A = ones(10) * ones(10)&#39; + Diagonal(1:10);

julia&gt; function power_iteration!(x_out, x_in, A)
           mul!(x_out, A, x_in)
           x_out ./= maximum(abs.(x_out))
       end;

julia&gt; res = speedmapping(ones(10); m! = (x_out, x_in) -&gt; power_iteration!(x_out, x_in, A))
(minimizer = [0.41214914122181, 0.44095060739689546, 0.4740798646565511, 0.5125916147320679, 0.5579135738427364, 0.6120273727167589, 0.677766040697063, 0.7593262786058278, 0.8632012019116191, 1.0], maps = 16, f_calls = 0, converged = true, norm_∇ = 2.8042637093700587e-9)

julia&gt; V = res.minimizer;

julia&gt; dominant_eigenvalue = V&#39;A * V / V&#39;V
16.310005690792195
</code></pre><p><strong>Example: Minimizing a multidimensional Rosenbrock</strong></p><pre><code class="nohighlight">julia&gt; f(x) = sum(100 * (x[i,1]^2 - x[i,2])^2 + (x[i,1] - 1)^2 for i ∈ 1:size(x,1));

julia&gt; function g!(∇, x)
           ∇[:,1] .=  400(x[:,1].^2 .- x[:,2]) .* x[:,1] .+ 2(x[:,1] .- 1)
           ∇[:,2] .= -200(x[:,1].^2 .- x[:,2])
           return nothing
       end;

julia&gt; x₀ = 1.0 * [-4 -3 -2 -1; 0 1 2 3]&#39;;</code></pre><p>Optimizing, providing f and g!</p><pre><code class="nohighlight">julia&gt; speedmapping(x₀; f, g!)
(minimizer = [0.9999999999962509 0.9999999999924867; 0.9999999999941136 0.9999999999882022; 0.9999999999752885 0.9999999999504781; 0.9999999989360835 0.9999999978679094], maps = 156, f_calls = 11, converged = true, norm_∇ = 9.524035730285234e-10)</code></pre><p>Optimizing without objective</p><pre><code class="nohighlight">julia&gt; speedmapping(x₀; g!)
(minimizer = [1.0000000000000542 1.0000000000001086; 0.9999999999999626 0.999999999999925; 0.9999999999997893 0.9999999999995778; 0.9999999999998465 0.9999999999996921], maps = 142, f_calls = 0, converged = true, norm_∇ = 3.524659991326121e-13)</code></pre><p>Optimizing without gradient</p><pre><code class="nohighlight">julia&gt; speedmapping(x₀; f)
(minimizer = [0.9999999999973896 0.9999999999947689; 0.9999999999958996 0.9999999999917817; 0.9999999999829567 0.9999999999658452; 0.9999999992743016 0.9999999985456991], maps = 156, f_calls = 11, converged = true, norm_∇ = 6.496402053553401e-10)</code></pre><p>Optimizing with a box constraint</p><pre><code class="nohighlight">julia&gt; upper = [0.5ones(4) Inf * ones(4)];

julia&gt; speedmapping(x₀; f, g!, upper)
(minimizer = [0.5 0.25; 0.5 0.24999999999999864; 0.49999999999999795 0.2499999999975679; 0.4999999999999807 0.2499999999773891], maps = 138, f_calls = 11, converged = true, norm_∇ = 7.196533863189794e-9)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NicolasL-S/SpeedMapping.jl/blob/b9debe63984e80c29373a6375abdcd63e0bd8f0f/src/main.jl#L335-L453">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Sunday 4 July 2021 21:13">Sunday 4 July 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
