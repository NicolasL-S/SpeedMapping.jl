<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SpeedMapping.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SpeedMapping.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NicolasL-S/SpeedMapping.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SpeedMapping.jl"><a class="docs-heading-anchor" href="#SpeedMapping.jl">SpeedMapping.jl</a><a id="SpeedMapping.jl-1"></a><a class="docs-heading-anchor-permalink" href="#SpeedMapping.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="SpeedMapping.speedmapping" href="#SpeedMapping.speedmapping"><code>SpeedMapping.speedmapping</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SpeedMapping</code></pre><p><code>speedmapping(x₀; m!, kwargs...)</code> accelerates the convergence of a mapping  <code>m!(x_out, x_in)</code> to a fixed point of <code>m!</code> by the Alternating cyclic  extrapolation algorithm (ACX). Since gradient descent is an example  of such mapping, <code>speedmapping(x0; g!, kwargs...)</code> can also perform multivariate  optimization based on the gradient function <code>g!(∇, x)</code>.</p><p>Reference: N. Lepage-Saucier, <em>Alternating cyclic extrapolation methods for optimization  algorithms</em>, arXiv:2104.04974 (2021). https://arxiv.org/abs/2104.04974</p><p><strong>Arguments</strong></p><ul><li><code>x₀ :: AbstractArray</code>: The starting point; must be of eltype <code>Float</code>.</li></ul><p>Main keyword arguments:</p><ul><li><code>m!(x_out, x_in)</code>: A map for which a fixed-point must be found.</li><li><code>g!(∇, x)</code>: The gradient of a function to be minimized.</li><li><code>f(x)</code>: The objective of the function to be minimized. It is useful to <em>i</em>)   compute a good initial α (learning  rate) for the gradient descent, <em>ii</em>)   optimize using autodiff or <em>iii</em>) track the progress of the algorithm.</li><li><code>lower, upper :: Union{AbstractArray, Nothing} = nothing</code>: Box constraints    for the optimization. NOTE: When appropriate, it should also be used with    <code>m!</code>. Even if <code>m!</code> always keeps <code>x_out</code> within bounds, an extrapolation    step could throw <code>x</code> out of bounds.</li><li><code>tol :: Float64 = 1e-10, Lp :: Real = 2</code> When using <code>m!</code>, the algorithm    stops when <code>norm(F(xₖ) - xₖ, Lp) ≤ tol</code>. When using <code>g!</code>, the algorithm    stops when <code>norm(∇f(xₖ), Lp) ≤ tol</code>. </li><li><code>maps_limit :: Real = 1e6</code>: Maximum number of <code>m!</code> calls or <code>g!</code> calls. </li><li><code>time_limit :: Real = 1000</code>: Maximum time in seconds.</li></ul><p>Minor keyword arguments:</p><ul><li><code>ord :: Int = 2 ∈ {1,2}</code> sets whether <code>ACX</code> alternates between <code>1</code>: <code>[3, 2]</code>    or <code>2</code>: <code>[3, 3, 2]</code> extrapolations. For highly non-linear applications, <code>2</code>    may be better, but there is no general rule (see paper).</li><li><code>check_obj :: Bool = false</code>: In case of <code>NaN</code> or <code>Inf</code> values, the algorithm   restarts at the best past iterate. If <code>check_obj = true</code>, progress is    monitored with the value of the objective (requires <code>f</code>).    Otherwise, it is monitored with <code>norm(F(xₖ) - xₖ, Lp)</code>. Advantages of    <code>check_obj = true</code>: more precise and if the algorithm convergences on a bad    local minimum, the algorithm instead returns the best past iterate.    Advantages of <code>check_obj = false</code>: for well-behaved applications, it avoids    the effort and time of providing <code>f</code> and calling it at every    iteration.</li><li><code>store_info :: Bool = false</code>: Stores <code>xₖ</code>, <code>σₖ</code> and <code>αₖ</code> (see paper).</li><li><code>buffer :: Float64 = 0.01</code> If <code>xₖ</code> goes out of bounds, it is brought back in   with a buffer. Ex. <code>xₖ = buffer * xₖ₋₁ + (1 - buffer) * upper</code>. Setting    <code>buffer = 0.001</code> may speed-up box-constrained optimization.</li></ul><p>Keyword arguments to fine-tune fixed-point mapping acceleration (using <code>m!</code>):</p><ul><li><code>σ_min :: Real = 0.0</code>: Setting to <code>1</code> may avoid stalling   (see paper).</li><li><code>stabilize :: Bool = false</code>: performs a stabilization mapping before    extrapolating. Setting to <code>true</code> may improve the performance for    applications like the EM or MM algorithm (see paper).</li></ul><p>Keyword arguments to fine-tune optimization (using <code>g!</code>):</p><ul><li><code>init_descent :: Float64 = 0.01</code> In case <code>f</code> is not provided, <code>α₀</code> (the    initial learning rate) is set to <code>init_descent</code>.</li><li><code>init_descent_manually :: Bool = false</code>: Forces the use of <code>init_descent</code>   even if <code>f</code> is provided.</li></ul><p><strong>Example: Finding a dominant eigenvalue</strong></p><pre><code class="language-julia-repl">julia&gt; using LinearAlgebra

julia&gt; using SpeedMapping

julia&gt; A = ones(10) * ones(10)&#39; + Diagonal(1:10);

julia&gt; function power_iteration!(x_out, x_in, A)
           mul!(x_out, A, x_in)
           x_out ./= maximum(abs.(x_out))
       end;

julia&gt; res = speedmapping(ones(10); m! = (x_out, x_in) -&gt; power_iteration!(x_out, x_in, A))
(minimizer = [0.412149140776937, 0.4409506066686425, 0.47407986422778675, 0.512591614439504, 0.557913573459803, 0.6120273722477959, 0.6777660401470581, 0.7593262779332898, 0.8632012008883913, 1.0], maps = 20, f_calls = 0, converged = true, norm_∇ = 3.0946706265554256e-11)

julia&gt; V = res.minimizer;

julia&gt; dominant_eigenvalue = V&#39;A * V / V&#39;V
16.3100056907922
</code></pre><p><strong>Example: Minimizing a multidimensional Rosenbrock</strong></p><pre><code class="nohighlight">julia&gt; f(x) = sum(100 * (x[i,1]^2 - x[i,2])^2 + (x[i,1] - 1)^2 for i ∈ 1:size(x,1));

julia&gt; function g!(∇, x)
           ∇[:,1] .=  400(x[:,1].^2 .- x[:,2]) .* x[:,1] .+ 2(x[:,1] .- 1)
           ∇[:,2] .= -200(x[:,1].^2 .- x[:,2])
           return nothing
       end;

julia&gt; x₀ = 1.0 * [-4 -3 -2 -1; 0 1 2 3]&#39;;</code></pre><p>Optimizing, providing f and g!</p><pre><code class="nohighlight">julia&gt; speedmapping(x₀; f, g!)
(minimizer = [0.9999999999406816 0.9999999998811234; 0.9999999999699053 0.9999999999396917; 0.9999999999608367 0.9999999999215149; 0.9999999999704666 0.9999999999408166], maps = 115, f_calls = 8, converged = true, norm_∇ = 8.257289534183707e-11)</code></pre><p>Optimizing without objective</p><pre><code class="nohighlight">julia&gt; speedmapping(x₀; g!)
(minimizer = [0.9999999999667474 0.9999999999333617; 0.9999999999560251 0.9999999999118742; 0.9999999999727485 0.9999999999453878; 0.9999999999142999 0.9999999998282568], maps = 148, f_calls = 0, converged = true, norm_∇ = 9.438023320576503e-11)</code></pre><p>Optimizing without gradient</p><pre><code class="nohighlight">julia&gt; speedmapping(x₀; f)
(minimizer = [0.9999999999362467 0.9999999998722411; 0.9999999999678646 0.999999999935602; 0.9999999999581914 0.9999999999162139; 0.9999999999687575 0.9999999999373889], maps = 107, f_calls = 8, converged = true, norm_∇ = 8.789493864861286e-11)</code></pre><p>Optimizing with a box constraint</p><pre><code class="nohighlight">julia&gt; upper = [0.5ones(4) Inf * ones(4)];

julia&gt; speedmapping(x₀; f, g!, upper)
(minimizer = [0.5 0.2499999999998795; 0.5 0.24999999999979697; 0.5 0.24999999999990052; 0.5 0.24999999999996994], maps = 91, f_calls = 8, converged = true, norm_∇ = 9.705761719383147e-11)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NicolasL-S/SpeedMapping.jl/blob/4717d1d594fd9951bb80cca09bf3bb545f9185e0/src/main.jl#L336-L459">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Wednesday 30 June 2021 21:09">Wednesday 30 June 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
